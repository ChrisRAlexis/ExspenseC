(()=>{var e={};e.id=841,e.ids=[841],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},98432:e=>{"use strict";e.exports=require("bcryptjs")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},18039:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>o,originalPathname:()=>m,pages:()=>x,routeModule:()=>p,tree:()=>d}),t(79958),t(53391),t(98052),t(35866),t(15495);var r=t(23191),a=t(88716),l=t(37922),i=t.n(l),n=t(95231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["(dashboard)",{children:["approvals",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,79958)),"/Users/chrisalexis/travel-expense-crm/src/app/(dashboard)/approvals/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,53391)),"/Users/chrisalexis/travel-expense-crm/src/app/(dashboard)/layout.tsx"],template:[()=>Promise.resolve().then(t.bind(t,98052)),"/Users/chrisalexis/travel-expense-crm/src/app/(dashboard)/template.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,15495)),"/Users/chrisalexis/travel-expense-crm/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],x=["/Users/chrisalexis/travel-expense-crm/src/app/(dashboard)/approvals/page.tsx"],m="/(dashboard)/approvals/page",o={require:t,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/approvals/page",pathname:"/approvals",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},26182:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,79404,23)),Promise.resolve().then(t.bind(t,38443)),Promise.resolve().then(t.bind(t,29752))},38443:(e,s,t)=>{"use strict";t.d(s,{Badge:()=>i});var r=t(10326),a=t(17577),l=t(51223);let i=(0,a.forwardRef)(({className:e,variant:s="default",...t},a)=>r.jsx("span",{ref:a,className:(0,l.cn)("badge",{default:"bg-slate-100 text-slate-700",draft:"bg-slate-100 text-slate-700",pending:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",changes:"bg-orange-100 text-orange-700"}[s],e),...t}));i.displayName="Badge"},29752:(e,s,t)=>{"use strict";t.d(s,{Card:()=>i,CardContent:()=>x,CardHeader:()=>n,CardTitle:()=>c,S:()=>d});var r=t(10326),a=t(17577),l=t(51223);let i=(0,a.forwardRef)(({className:e,variant:s="default",...t},a)=>r.jsx("div",{ref:a,className:(0,l.cn)("rounded-3xl border p-5 transition-all duration-300",{default:"bg-white/40 backdrop-blur-2xl border-white/50 shadow-[0_8px_32px_rgba(0,0,0,0.06)] hover:bg-white/50 hover:shadow-[0_8px_32px_rgba(0,0,0,0.1)]",solid:"bg-white/50 backdrop-blur-2xl border-white/60 shadow-[0_8px_32px_rgba(0,0,0,0.08)]",gradient:"bg-gradient-to-br from-white/50 via-white/40 to-white/30 backdrop-blur-2xl border-white/50 shadow-[0_8px_32px_rgba(0,0,0,0.06)]"}[s],e),...t}));i.displayName="Card";let n=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 pb-5",e),...s}));n.displayName="CardHeader";let c=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("h3",{ref:t,className:(0,l.cn)("text-lg font-semibold text-slate-900",e),...s}));c.displayName="CardTitle";let d=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("p",{ref:t,className:(0,l.cn)("text-sm text-slate-500",e),...s}));d.displayName="CardDescription";let x=(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("",e),...s}));x.displayName="CardContent",(0,a.forwardRef)(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("flex items-center pt-5",e),...s})).displayName="CardFooter"},33515:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(27162).Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},49268:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(27162).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},14120:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(27162).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},74780:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(27162).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},42127:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(27162).Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]])},57371:(e,s,t)=>{"use strict";t.d(s,{default:()=>a.a});var r=t(670),a=t.n(r)},670:(e,s,t)=>{"use strict";let{createProxy:r}=t(68570);e.exports=r("/Users/chrisalexis/travel-expense-crm/node_modules/next/dist/client/link.js")},79958:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var r=t(19510),a=t(75571),l=t(95456),i=t(13538),n=t(57371),c=t(42127),d=t(14120),x=t(27162);let m=(0,x.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),o=(0,x.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var p=t(49268),h=t(33515),u=t(74780),g=t(93804),b=t(59558),j=t(40644);async function f(e,s){let t=(await i._.expense.findMany({where:{status:"PENDING",userId:{not:e}},orderBy:{submittedAt:"desc"},include:{user:{include:{manager:!0}},items:!0,receipts:!0,workflow:{include:{steps:{include:{approver:!0},orderBy:{stepOrder:"asc"}}}}}})).filter(t=>{if("ADMIN"===s||t.user.managerId===e)return!0;if(!t.workflow)return"APPROVER"===s;let r=t.workflow.steps[t.currentStep];return r?.approverId===e}),r=await i._.approvalAction.findMany({where:{approverId:e},orderBy:{createdAt:"desc"},take:20,include:{expense:{include:{user:!0,items:!0}}}}),a=t.reduce((e,s)=>e+s.totalAmount,0),l=r.filter(e=>"APPROVED"===e.action&&new Date(e.createdAt).getMonth()===new Date().getMonth()),n=l.reduce((e,s)=>e+s.expense.totalAmount,0),c=t.filter(e=>e.totalAmount>500).length;return{pendingExpenses:t,approvalHistory:r,stats:{totalPendingAmount:a,totalApprovedAmount:n,highValueCount:c,approvedCount:l.length}}}async function N(){let e=await (0,a.getServerSession)(l.L);if(!e)return null;let{pendingExpenses:s,approvalHistory:t,stats:i}=await f(e.user.id,e.user.role);return"APPROVER"===e.user.role||"ADMIN"===e.user.role?(0,r.jsxs)("div",{className:"space-y-4 sm:space-y-6 animate-fade-in overflow-x-hidden",children:[r.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-emerald-800/80",children:"Approvals"}),r.jsx("p",{className:"text-slate-400/80 text-sm mt-1",children:"Review and approve expenses"})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(g.Zb,{className:"bg-gradient-to-br from-amber-400/80 to-amber-500/80 text-white border-0",children:r.jsx(g.aY,{className:"p-3 sm:p-5",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-amber-100 text-xs sm:text-sm font-medium truncate",children:"Pending"}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold mt-1",children:s.length}),r.jsx("p",{className:"text-amber-200 text-xs mt-1 truncate",children:(0,j.xG)(i.totalPendingAmount)})]}),r.jsx("div",{className:"p-2 sm:p-3 bg-white/20 rounded-xl shrink-0",children:r.jsx(d.Z,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]})})}),r.jsx(g.Zb,{className:"bg-gradient-to-br from-emerald-400/80 to-emerald-500/80 text-white border-0",children:r.jsx(g.aY,{className:"p-3 sm:p-5",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-emerald-100 text-xs sm:text-sm font-medium truncate",children:"Approved"}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold mt-1",children:i.approvedCount}),r.jsx("p",{className:"text-emerald-200 text-xs mt-1 truncate",children:(0,j.xG)(i.totalApprovedAmount)})]}),r.jsx("div",{className:"p-2 sm:p-3 bg-white/20 rounded-xl shrink-0",children:r.jsx(m,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]})})}),r.jsx(g.Zb,{className:"bg-gradient-to-br from-red-400/80 to-red-500/80 text-white border-0",children:r.jsx(g.aY,{className:"p-3 sm:p-5",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-red-100 text-xs sm:text-sm font-medium truncate",children:"High Value"}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold mt-1",children:i.highValueCount}),r.jsx("p",{className:"text-red-200 text-xs mt-1 truncate",children:">$500"})]}),r.jsx("div",{className:"p-2 sm:p-3 bg-white/20 rounded-xl shrink-0",children:r.jsx(o,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]})})}),r.jsx(g.Zb,{className:"bg-gradient-to-br from-indigo-400/80 to-indigo-500/80 text-white border-0",children:r.jsx(g.aY,{className:"p-3 sm:p-5",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-indigo-100 text-xs sm:text-sm font-medium truncate",children:"Rejected"}),r.jsx("p",{className:"text-xl sm:text-2xl font-bold mt-1",children:t.filter(e=>"REJECTED"===e.action).length}),r.jsx("p",{className:"text-indigo-200 text-xs mt-1 truncate",children:"All time"})]}),r.jsx("div",{className:"p-2 sm:p-3 bg-white/20 rounded-xl shrink-0",children:r.jsx(p.Z,{className:"h-5 w-5 sm:h-6 sm:w-6"})})]})})})]}),(0,r.jsxs)(g.Zb,{className:"overflow-hidden",children:[r.jsx(g.Ol,{className:"p-3 sm:p-6",children:(0,r.jsxs)(g.ll,{className:"flex items-center gap-2 text-sm sm:text-base",children:[r.jsx(d.Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-yellow-500"}),"Pending (",s.length,")"]})}),r.jsx(g.aY,{className:"p-3 sm:p-6 pt-0",children:0===s.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[r.jsx(h.Z,{className:"h-12 w-12 text-green-300 mx-auto mb-3"}),r.jsx("p",{className:"text-slate-500",children:"All caught up!"}),r.jsx("p",{className:"text-sm text-slate-400",children:"No expenses pending your review."})]}):r.jsx("div",{className:"space-y-3 sm:space-y-4",children:s.map(e=>r.jsx(n.default,{href:`/expenses/${e.id}`,className:"block p-3 sm:p-4 rounded-xl hover:bg-slate-50 transition-colors border border-slate-100 hover:border-slate-200",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2 sm:gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2 sm:gap-3 min-w-0 flex-1",children:[r.jsx("div",{className:"w-9 h-9 sm:w-11 sm:h-11 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center shrink-0",children:r.jsx("span",{className:"text-xs sm:text-sm font-semibold text-white",children:e.user.name.split(" ").map(e=>e[0]).join("")})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2 flex-wrap",children:[r.jsx("p",{className:"font-semibold text-slate-700/90 text-sm sm:text-base truncate",children:e.title}),e.totalAmount>500&&r.jsx("span",{className:"text-xs px-1 sm:px-1.5 py-0.5 bg-red-100 text-red-600 rounded-full shrink-0",children:"High"})]}),(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-slate-600 mt-0.5 truncate",children:[e.user.name,e.user.department&&(0,r.jsxs)("span",{className:"text-slate-400",children:[" \xb7 ",e.user.department]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-x-2 sm:gap-x-3 gap-y-1 mt-1 sm:mt-2 text-xs text-slate-500",children:[(0,r.jsxs)("span",{className:"inline-flex items-center gap-1",children:[r.jsx(c.Z,{className:"h-3 w-3"}),e.receipts.length]}),(0,r.jsxs)("span",{className:"inline-flex items-center gap-1",children:[r.jsx(u.Z,{className:"h-3 w-3"}),e.items.length]}),r.jsx("span",{className:"capitalize px-1.5 py-0.5 bg-slate-100 rounded",children:e.category.toLowerCase()})]})]})]}),(0,r.jsxs)("div",{className:"text-right shrink-0",children:[r.jsx("p",{className:"text-base sm:text-lg font-bold text-slate-600/90",children:(0,j.xG)(e.totalAmount)}),r.jsx("p",{className:"text-xs text-slate-400 mt-1 hidden sm:block",children:(0,j.p6)(e.submittedAt)}),r.jsx(b.C,{variant:"pending",className:"mt-1 sm:mt-2 text-xs",children:"Review"})]})]})},e.id))})})]}),t.length>0&&(0,r.jsxs)(g.Zb,{className:"overflow-hidden",children:[r.jsx(g.Ol,{className:"p-3 sm:p-6",children:r.jsx(g.ll,{className:"text-sm sm:text-base",children:"Your Approval History"})}),r.jsx(g.aY,{className:"p-3 sm:p-6 pt-0",children:r.jsx("div",{className:"space-y-2 sm:space-y-3",children:t.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between py-2 sm:py-3 px-2 sm:px-3 rounded-lg hover:bg-slate-50 transition-colors border-b border-slate-100 last:border-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[r.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center shrink-0 ${"APPROVED"===e.action?"bg-emerald-100":"REJECTED"===e.action?"bg-red-100":"bg-orange-100"}`,children:"APPROVED"===e.action?r.jsx(h.Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-600"}):"REJECTED"===e.action?r.jsx(p.Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-red-600"}):r.jsx(d.Z,{className:"h-4 w-4 sm:h-5 sm:w-5 text-orange-600"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[r.jsx("p",{className:"font-medium text-slate-700/90 text-sm truncate",children:e.expense.title}),r.jsx("p",{className:"text-xs sm:text-sm text-slate-500 truncate",children:e.expense.user.name})]})]}),(0,r.jsxs)("div",{className:"text-right shrink-0 ml-2 sm:ml-4",children:[r.jsx("p",{className:"font-semibold text-slate-600/90 text-sm",children:(0,j.xG)(e.expense.totalAmount)}),r.jsx("p",{className:"text-xs text-slate-400 hidden sm:block",children:(0,j.p6)(e.createdAt)}),r.jsx(b.C,{variant:"APPROVED"===e.action?"approved":"REJECTED"===e.action?"rejected":"changes",className:"mt-1 text-xs",children:"CHANGES_REQUESTED"===e.action?"Changes":e.action})]})]},e.id))})})]})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-xl sm:text-2xl font-semibold text-emerald-800/80",children:"Approvals"}),r.jsx(g.Zb,{children:(0,r.jsxs)(g.aY,{className:"py-12 text-center",children:[r.jsx(c.Z,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),r.jsx("p",{className:"text-slate-500",children:"You don't have approval permissions."}),r.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Contact an admin to request approver access."})]})})]})}},59558:(e,s,t)=>{"use strict";t.d(s,{C:()=>r});let r=(0,t(68570).createProxy)(String.raw`/Users/chrisalexis/travel-expense-crm/src/components/ui/badge.tsx#Badge`)},93804:(e,s,t)=>{"use strict";t.d(s,{Ol:()=>l,Zb:()=>a,aY:()=>n,ll:()=>i});var r=t(68570);let a=(0,r.createProxy)(String.raw`/Users/chrisalexis/travel-expense-crm/src/components/ui/card.tsx#Card`),l=(0,r.createProxy)(String.raw`/Users/chrisalexis/travel-expense-crm/src/components/ui/card.tsx#CardHeader`),i=(0,r.createProxy)(String.raw`/Users/chrisalexis/travel-expense-crm/src/components/ui/card.tsx#CardTitle`);(0,r.createProxy)(String.raw`/Users/chrisalexis/travel-expense-crm/src/components/ui/card.tsx#CardDescription`);let n=(0,r.createProxy)(String.raw`/Users/chrisalexis/travel-expense-crm/src/components/ui/card.tsx#CardContent`);(0,r.createProxy)(String.raw`/Users/chrisalexis/travel-expense-crm/src/components/ui/card.tsx#CardFooter`)},40644:(e,s,t)=>{"use strict";function r(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function a(e){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(new Date(e))}t.d(s,{p6:()=>a,xG:()=>r})}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,790,672,42,829,127],()=>t(18039));module.exports=r})();